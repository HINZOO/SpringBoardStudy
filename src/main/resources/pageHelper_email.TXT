1. í˜ì´ì§•ì€ ì¿¼ë¦¬ì˜ ë§¨ë’¤ì— ì‘ì„±í•œë‹¤.
    1) 0ë²ˆ ì¸ë±ìŠ¤ ë¶€í„° ì´ 5ê°œ(offset)ë¥¼ ë³´ì—¬ì£¼ê² ë‹¤.
    SELECT * FROM boards LIMIT 0,5

    2) 2ë²ˆ í˜ì´ì§€
    SELECT * FROM boards LIMIT 5,5
    ->2ë²ˆ í˜ì´ì§€

    3) në²ˆ í˜ì´ì§€
    -DESC : ë‚´ë¦¼ì°¨ìˆœì •ë ¬
    SELECT * FROM boards DESC LIMIT ((page-1)*5),5;

2. WHERE ì ˆì€ ORDER BY ì•ˆìª½
    1) ì—´ ì„ í¬í•¨í•˜ê³  ìˆëŠ” ì½˜í…ì¸ ë¥¼ ì°¾ëŠ” ì¿¼ë¦¬.
    SELECT * FORM boards WHERE  content like '%ì—´%' ORDER BY update_time DESC;
    = ê³¼ like >> likeëŠ” ìœ ì‚¬í•œê²ƒì„ ë§í•œë‹¤. likeê°€ ë˜ì–´ì•¼ ì—´ì´ ë“¤ì–´ê°„ ì¹œêµ¬ë“¤ì„ ì°¾ëŠ”ë° ì‚¬ì‹¤ ì´ëŒ€ë¡œëŠ” ì•ˆë˜ê³ 
    %ì™€ì¼ë“œ ì¹´ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•´ì•¼ ì—´ì´ ë“¤ì–´ê°„ ê¸€ìë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.

    2) 4ë²ˆì§¸ì— ì—´ì´ ì˜¤ëŠ” ê²ƒì„ ì°¾ê¸°.
    SELECT * FORM boards WHERE  content like '___ì—´%' ORDER BY update_time DESC;

    3) ì•ˆë…•í•˜ì„¸ìš”ê°€ ì•ì— ì˜¤ëŠ” ì¿¼ë¦¬
    SELECT * FORM boards WHERE  content like 'ì•ˆë…•í•˜ì„¸ìš”%' ORDER BY update_time DESC;

    4) ì•ìª½ì— ì‘ì„±íƒœê·¸ ì²«ê¸€ìê°€ ì˜¤ëŠ” ì¿¼ë¦¬
    SELECT * FROM hashtags WHERE tag like CONCAT(#{tag},'%');

    5) ì¼ë°˜ ê²€ìƒ‰ ì¿¼ë¦¬ (+í˜ì´ì§•)
    SELECT * FROM boards WHERE content like CONCAT ('%','ì—´','%') ORDER BY update_time DESC LIMIT 0,5;
3)ê²€ìƒ‰ ì¿¼ë¦¬ ì‘ì„±ì‹œ ìœ ì˜ì‚¬í•­
    <select id="findAll" resultMap="BoardMap" parameterType="PageDto">
        SELECT * FROM boards ORDER BY ${order} ${direct} LIMIT #{startIndex},#{offset}
    </select>

    6) ì„œì¹˜í•„ë“œê°€ ìˆìœ¼ë©´ ì„œì¹˜í•´ì„œ ê²°ê³¼ ì§„í–‰.
        <select id="findAll" resultMap="BoardMap" parameterType="PageDto">
            SELECT
                * FROM boards
                <if test="searchField!=null and searchValue!=null"> /*ë‹¤ì´ë‚˜ë¯¹ ì¿¼ë¦¬*/
                    WHERE ${searchField} LIKE CONCAT('%',#{searchValue},'%')
                </if>
                  ORDER BY ${order} ${direct}
                  LIMIT #{startIndex},#{offset}
        </select>

3.í˜ì´ì§€í—¬í¼ -> í˜ì´ì§•ì€ í•´ì£¼ê³  ì„œì¹˜ëŠ” ìš°ë¦¬ê°€ ë§Œë“¤ì–´ì•¼í•¨.

        controllerì—ì„œ..
            PageHelper.startPage(1,5,"b_id DESC");
            PageInfo<BoardDto> pageBoards=new PageInfo<>(boards);
            model.addAttribute("boards",pageBoards); í•´ì£¼ë©´
            ë‹¤ìŒì˜ ê°’ë“¤ì´ ì¶œë ¥ë¨
            isFristPage, isLastPage, hasNextPage, navigatePages,navigateFirstPage,navigateLastPage,navigatePageNums=[]
            ì´ë•Œ addAttributeë¥¼ ì €ë ‡ê²Œ ê°™ì´ í•´ë²„ë¦¬ë©´,ì–´ë ¤ì›€? ì™œ? =3=?

            PageHelper.startPage(1,5,"b_id DESC");//í˜„ì¬í˜ì´ì§€/ì˜¤í”„ì…‹/orderby
                                                              //reasonable=trueì´ë©´ í˜ì´ì§€ê°€ -1ì¼ë•Œ, 1ë²ˆí˜ì´ì§€ë¡œ ì·¨ê¸‰í•´ì£¼ëŠ”ê²ƒ.
            boards=boardService.list(loginUser);
            PageInfo<BoardDto> pageBoards=new PageInfo<>(boards);
            model.addAttribute("page",pageBoards);
            model.addAttribute("boards",boards);
            ë¦¬ìŠ¤íŠ¸ë¼ëŠ”ì´ë¦„ìœ¼ë¡œ ë‹¤ìŒì˜ ë‚´ìš©ë“¤ì´ ìƒë‹¨ì— ë„˜ì–´ê°€ì„œ ë³´ë“œì—ì„œ b:list ë¼ê³  ëª…ëª…í•´ì¤€ë‹¤.
            list=Page{count=true, pageNum=1, pageSize=5, startRow=0, endRow=5, total=88, pages=18,//ë¼ìŠ¤íŠ¸í˜ì´ì§€ë¥¼ ì •í• ë•Œ ì‚¬ìš©
            reasonable=true, pageSizeZero=false}
           -ê¸°ë³¸ì„¤ì •
           ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì´ë ‡ê²Œ í•´ì¤„ë•Œ,
           PageHelper.startPage(6,5,"b_id DESC");
           ë³´ë“œì˜ ë‹¤ìŒì„¤ì •ì´ ë„˜ì–´ê°.
            prePage=5, nextPage=7, isFirstPage=false, isLastPage=false,
            hasPreviousPage=true, hasNextPage=true,
            navigatePages=8,(í˜„ì¬ ì˜ˆì‹œë¡œëŠ” 15ê°œì˜ í˜ì´ì§€ê°€ ë‚˜ì˜¤ì§€ë§Œ ê·¸ì¤‘ 8ê°œì˜ í˜ì´ì§€ê°€ ëˆˆì— ë³´ì—¬ì§„ë‹¤.) navigateFirstPage=2, navigateLastPage=9,
            navigatepageNums=[2, 3, 4, 5, 6, 7, 8, 9]



ğŸ˜ ê°€ì… ì´ë©”ì¼ ì²´í¬ ì„œë¹„ìŠ¤ êµ¬í˜„í•˜ê¸°

[yml]
1.smtp: simple mail transfer protocol  ë©”ì¼ ë³´ë‚´ì£¼ëŠ” í”„ë¡œí† ì½œ
    - ì´ë•Œ í¬íŠ¸ ë²ˆí˜¸ëŠ” ê³ ì •ë˜ì–´ ë°”ê¿€ ìˆ˜ ì—†ë‹¤.
    - ë©”ì¼ì„ ë³´ë‚´ëŠ” ë©”ì¼ ì£¼ì†Œì™€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•´ ë‘”ë‹¤.
    - ì´ë•Œ ê³„ì •ì„ ë§Œë“¤ì–´ì„œ 2ì°¨ì¸ì¦ì„ í•´ì•¼ ë¨.
    .gitIgnore ì— application.yml ì„ ì¶”ê°€
2. [service]  mineMessageHelper - ë©”ì¼ì„ ë³´ë‚¼ë•Œ ì‚¬ìš©í•˜ëŠ” ê°ì²´

[ìˆœì„œ]
1.ì¢…ì†ì„± ì¶”ê°€
   implementation 'org.springframework.boot:spring-boot-starter-mail:3.0.4'
2. ymlì— ì¶”ê°€.
  mail:
    host: smtp.gmail.com #smtpë¥¼ ì‚¬ìš©í•˜ì—¬ gmailë¡œ ë³´ë‚´ê² ë‹¤
    port: 587 #ì•½ì†ëœ ê°’ìœ¼ë¡œ ë³€ê²½ ë¶ˆê°€
    username: hinge1128@gmail.com
    password: ì•±ë¹„ë°€ë²ˆí˜¸ #êµ¬ê¸€ 2ë‹¨ê³„ì¸ì¦-> 2ë‹¨ê³„ì¸ì¦ ìƒì„¸-> ì•± ë¹„ë°€ë²ˆí˜¸
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
3.emailDto ìƒì„±
 ì´ë•Œ ë³€ìˆ˜ëª…ì€ ë§ˆìŒëŒ€ë¡œ ì¨ë„ ëœë‹¤.
 ë³´ë‚´ëŠ” ì‚¬ëŒ / ì œëª© / ë‚´ìš©

 4.EmailService ìƒì„±
 @Component ì–´ë…¸í…Œì´ì…˜ ì •ì˜
    (@Service ëŠ” @Component ì˜ ìì‹ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ
    ì—¬ëŸ¬ Dao ë¥¼ ì‹¤í–‰í•˜ê³  @Transaction ì„ ì •ì˜í•  ë•Œ ì‚¬ìš©,
     ëª…ì‹œì ì¸ ëª©ì ë„ ìˆìŒ. ìš°ë¦¬ëŠ” DBë¥¼ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆê¸°ì— ì„œë¹„ìŠ¤ ì–´ë…¸í…Œì´ì…˜ì„ ì“°ì§€ ì•ŠëŠ”ë‹¤)
  JavaMailSender ì¸í„°í˜ì´ìŠ¤ ë¶ˆëŸ¬ì˜¤ê³  ìƒì„±ì ì¶”ê°€(ì´ë©”ì¼ì„ ë³´ë‚´ëŠ” ì¸í„°í˜ì´ìŠ¤)
  MimeMessage í´ë˜ìŠ¤ ë¶ˆëŸ¬ì˜¤ê³  MimeMessageHelper ë¶ˆëŸ¬ì˜¤ê¸°
  mimeMessageHelper.setTo(emailDto.getToUser()); ì˜ˆì™¸ìœ„ì„.
  ëª‡ê°€ì§€ ì…‹íŒ… í›„
  javaMailSender.send(mimeMessage); ë¡œ ì „ì†¡!

       [*ì°¸ê³ ] ì¶œì²˜:https://www.baeldung.com/spring-email
       Spring í”„ë ˆì„ì›Œí¬ì—ì„œ Java ë©”ì¼ ì§€ì›ì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ ë° í´ë˜ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤.
       1)MailSender ì¸í„°í˜ì´ìŠ¤ : ê°„ë‹¨í•œ ì´ë©”ì¼ ì „ì†¡ì„ ìœ„í•œ ê¸°ë³¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤
       2)JavaMailSender ì¸í„°í˜ì´ìŠ¤ : ìœ„ MailSender ì˜ í•˜ìœ„ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤ . MIME ë©”ì‹œì§€ë¥¼ ì§€ì›í•˜ë©° ì£¼ë¡œ MimeMessage ìƒì„±ì„ ìœ„í•´ MimeMessageHelper í´ë˜ìŠ¤ ì™€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ì¸í„°í˜ì´ìŠ¤ì™€ í•¨ê»˜ MimeMessagePreparator ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
       3)JavaMailSenderImpl í´ë˜ìŠ¤ëŠ” JavaMailSender ì¸í„°í˜ì´ìŠ¤  êµ¬í˜„ì„ ì œê³µí•©ë‹ˆë‹¤. MimeMessage ë° SimpleMailMessage ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
       4)SimpleMailMessage í´ë˜ìŠ¤ : ë³´ë‚¸ ì‚¬ëŒ, ë°›ëŠ” ì‚¬ëŒ, ì°¸ì¡°, ì œëª© ë° í…ìŠ¤íŠ¸ í•„ë“œë¥¼ í¬í•¨í•˜ëŠ” ê°„ë‹¨í•œ ë©”ì¼ ë©”ì‹œì§€ë¥¼ ë§Œë“œëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
       5)MimeMessagePreparator ì¸í„°í˜ì´ìŠ¤ëŠ” MIME ë©”ì‹œì§€ ì¤€ë¹„ë¥¼ ìœ„í•œ ì½œë°± ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
       6)MimeMessageHelper í´ë˜ìŠ¤ : MIME ë©”ì‹œì§€ ìƒì„±ì„ ìœ„í•œ ë„ìš°ë¯¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤. HTML ë ˆì´ì•„ì›ƒì˜ ì´ë¯¸ì§€, ì¼ë°˜ì ì¸ ë©”ì¼ ì²¨ë¶€ íŒŒì¼ ë° í…ìŠ¤íŠ¸ ì½˜í…ì¸ ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

  5.í…ŒìŠ¤íŠ¸ ëŒë ¤ë³´ê¸°
   emailService.sendMail(emailDto);//ì˜ˆì™¸ìœ„ì„
  6.DB ë³€ê²½
    # ALTER TABLE í…Œì´ë¸”ëª… ADD COLUMN ì¹¼ëŸ¼ëª…: ë¶€ë¶„ ì ì¸ í…Œì´ë¸” ë³€ê²½
    ALTER TABLE users ADD COLUMN status    ENUM('SIGNUP','EMAIL_CHECK','BLOCK','LEAVE','REPORT') NOT NULL DEFAULT 'SIGNUP' COMMENT 'ê³„ì •ìƒíƒœ';
    ALTER TABLE users ADD COLUMN     email_check_code VARCHAR(8) COMMENT 'ì´ë©”ì¼ í™•ì¸ ì½”ë“œ';
  7.UserDto ê°’ ë³€ê²½(DBë¥¼ ë³€ê²½í–ˆìŒìœ¼ë¡œ)
    enum ì„ public ì„¤ì •-importë¥¼ í•˜ê¸° ìœ„í•´ì„œ.
  8.UserMapper.java
    int updateStatusByUIdAndEmailCheckCode(UserDto user);//ì´ë©”ì¼ ì²´í¬ ì½”ë“œë¡œ ìœ ì €ë¥¼ íšŒì›ê°€ì…ìƒíƒœë¡œ ë³€ë™
  9.UserMapper.xml
     <update id="updateStatusByUIdAndEmailCheckCode">
          UPDATE users SET status=#{status} WHERE u_id=#{uId} AND email_check_code=#{emailCheckCode}
      </update>

     insert ë¬¸ì—ë„ status,email_check_code ì¶”ê°€ í•´ì£¼ê¸°
     resultMapì—ë„ ì„¤ì •

  10.UserController
   0)EmailService ì£¼ì…
   [@PostMapping("/signUp.do)ë¡œ ì´ë™"]
   1)8ìë¦¬ ë‚œìˆ˜ìƒì„±
       SecureRandom random=new SecureRandom();//ë‚œìˆ˜ìƒì„±//ë°”ì´íŠ¸ì¸ì½”ë”©ìœ¼ë¡œ ë‚œìˆ˜ìƒì„±
       byte[] bytes=new byte[6];
       random.nextBytes(bytes);//ëœë¤ ì½”ë“œ ìƒì„±
       Base64.getUrlEncoder().withoutPadding().encodeToString(bytes);//ëœë¤ì½”ë“œë¥¼ ë¬¸ìì—´ë¡œ ì¸ì½”ë”©(Base64)
   2)ìœ ì € ì…‹íŒ…
        user.setEmailCheckCode(emailCheckCode);
        user.setStatus(UserDto.StatusType.EMAIL_CHECK);
        ê°€ì…ì´ ì„±ê³µí• ë•Œ (signUp>0 ì´ë©´)
        ë©”ì¼ì„ ë³´ë‚´ë„ë¡ EmailDto ìƒì„± í›„ ì…‹íŒ…í•œë‹¤.
         EmailDto emailDto=new EmailDto();
         emailDto.setToUser(user.getEmail());
         emailDto.setTitle("í…ŒìŠ¤íŠ¸ ì›¹ì‚¬ì´íŠ¸ ì´ë©”ì¼ í™•ì¸ì½”ë“œ");
         emailDto.setMessage("<h2>í•´ë‹¹ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”</h2><br><h3>CODE : "+emailCheckCode+"</h3>");
         emailService.sendMail(emailDto);
    *íŒŒë¼ë¯¸í„°ë¡œ uIdì˜ ê°’ì„ ë³´ë‚´ì•¼ í•¨(ê°œì¸ì ì¸ê²ƒì´ê¸° ë•Œë¬¸, ê°ì¶œì‚¬í•­ì€ ì•„ë‹ˆê¸°ì— ì„¸ì…˜ì´ ì•„ë‹Œ íŒŒë¼ë¯¸í„°ë¡œ ë³´ë‚¸ë‹¤)
        ë³¸ë˜ ì´ë ‡ê²Œ ì¨ì•¼ í•¨.
        return "redirect:/user/emailCheck.do?uId="+user.getUId();
        í•˜ì§€ë§Œ
        redirectAttributes.addAttribute("uId",user.getUId());
        return "redirect:/user/emailCheck.do";
        ì´ ì‘ì—…ì„ í•˜ë©´ redirect ë’¤ì— íŒŒë¼ë¯¸í„°ë¡œ ìë™ìœ¼ë¡œ uIdë¥¼ ë³´ëƒ„.
   3)@GetMapping("/emailCheck.do") ìƒì„±

11.emailCheck.html ìƒì„±
-interceptorConfig  .excludePathPatterns("/user/emailCheck.do")ì¶”ê°€
 <input type="text" name="uId" th:value="${param.uId}"> ë¡œ íŒŒë¼ë¯¸í„°ê°€ ì˜ ë“¤ì–´ì˜¤ëŠ”ì§€ ì²´í¬
 í™•ì¸ í›„ typeì„ hiddenìœ¼ë¡œ ë³€ê²½

12.UserService
    modifyEmailCheck ìƒì„± UserDtoë¥¼ ë‹´ëŠ”ë‹¤.
13.UserSeviceImpl
    ìƒì„± êµ¬í˜„
    int modifyEmailCheck=userMapper.updateStatusByUIdAndEmailCheckCode(user);

14.UserController
    @PostMapping("/emailCheck.do") ì˜ ê¸°ë³¸ë¼ˆëŒ€ ë§Œë“¤ê¸°.

15.UserController
@PostMapping("/login.do") ì—ì„œ
ì´ë©”ì¼ì²´í¬ë¥¼ ì•ˆí•˜ë©´ ë¡œê·¸ì¸ì´ ì•ˆë˜ë„ë¡ ì„¤ì •í•˜ê¸°
ì´ë©”ì¼ì²´í¬ë¥¼ ì•ˆí–ˆì„ì‹œ /emailCheck.do ë¡œ ë„˜ì–´ê°ˆë•Œ redirectAttributes.addAttribute("uId",loginUser.getUId())ë¡œ  uIdë¥¼ ê³„ì† ì „ë‹¬í•´ ì¤˜ì•¼í•œë‹¤.
   if(loginUser.getStatus()==UserDto.StatusType.EMAIL_CHECK){
             redirectAttributes.addFlashAttribute("msg","ì´ë©”ì¼ì„ í™•ì¸í•´ì•¼ ê°€ì…ì´ ì™„ë£Œë©ë‹ˆë‹¤.");
             redirectAttributes.addAttribute("uId",loginUser.getUId());
             return "redirect:/user/emailCheck.do";
         }

16. @PostMapping("/emailCheck.do")
update ì¶”ê°€.
 user.setStatus(UserDto.StatusType.SIGNUP);
 emailCheck= userService.modifyEmailCheck(user);

